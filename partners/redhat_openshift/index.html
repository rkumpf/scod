<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
    
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Hewlett Packard Enterprise">
  <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta property="og:title" content="HPE Storage Container Orchestrator Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Kubernetes and Docker integrations for HPE primary storage tailored for IT Ops, developers and partners. Including HPE 3PAR and Primera, HPE Cloud Volumes and HPE Nimble Storage."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://scod.hpedev.io"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://scod.hpedev.io/img/hpe-social-og-image01.jpg"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    
  <title>Red Hat OpenShift - HPE Storage Container Orchestrator Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../../css/hpedev.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "Red Hat OpenShift";
    var mkdocs_page_input_path = "partners/redhat_openshift/index.md";
    var mkdocs_page_url = "/partners/redhat_openshift/index.html";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-79554149-3', 'auto');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> HPE Storage Container Orchestrator Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <span class="caption-text">WELCOME</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../welcome/index.html">Get started!</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">HPE CSI DRIVER FOR KUBERNETES</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../csi_driver/index.html">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../csi_driver/deployment.html">Deployment</a>
                </li>
                <li class="">
                    
    <a class="" href="../../csi_driver/using.html">Using</a>
                </li>
                <li class="">
                    
    <a class="" href="../../csi_driver/monitor.html">Pod Monitor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../csi_driver/diagnostics.html">Diagnostics</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">CONTAINER STORAGE PROVIDERS</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../container_storage_provider/hpe_3par_primera/index.html">HPE 3PAR and Primera</a>
                </li>
                <li class="">
                    
    <a class="" href="../../container_storage_provider/hpe_nimble_storage/index.html">HPE Nimble Storage</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">LEGACY FLEXVOLUME DRIVER</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../flexvolume_driver/container_provider/index.html">Container Provider: Nimble and CV</a>
                </li>
                <li class="">
                    
    <a class="" href="../../flexvolume_driver/hpe_3par_primera_installer/index.html">Ansible installer for 3PAR/Primera</a>
                </li>
                <li class="">
                    
    <a class="" href="../../flexvolume_driver/dory/index.html">History: Dory and Doryd </a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">DOCKER VOLUME PLUGINS</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../docker_volume_plugins/hpe_cloud_volumes/index.html">HPE Cloud Volumes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../docker_volume_plugins/hpe_nimble_storage/index.html">HPE Nimble Storage</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">PARTNER ECOSYSTEMS</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../rancher_labs/index.html">Rancher Labs</a>
                </li>
                <li class=" current">
                    
    <a class="current" href="index.html">Red Hat OpenShift</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#overview">Overview</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#openshift_4">OpenShift 4</a></li>
        
            <li><a class="toctree-l4" href="#openshift_3">OpenShift 3</a></li>
        
        </ul>
    

    </ul>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">LEARN</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../learn/containers101/index.html">Cloud-Native, Containers & DevOps</a>
                </li>
                <li class="">
                    
    <a class="" href="../../learn/persistent_storage/index.html">Persistent Storage for Kubernetes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../learn/introduction_to_containers/index.html">For HPE partners:<br />&nbsp;&nbsp; Introduction to Containers</a>
                </li>
                <li class="">
                    
    <a class="" href="../../learn/video_gallery/index.html">Video Gallery</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">COMMUNITY</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="https://developer.hpe.com">HPE Developer Community</a>
                </li>
                <li class="">
                    
    <a class="" href="https://slack.hpedev.io">Sign up to HPE DEV on Slack</a>
                </li>
                <li class="">
                    
    <a class="" href="https://github.com/hpe-storage/scod/issues/new?title=I have some feedback on SCOD">Got feedback?</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">EXTERNAL LINKS</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="https://github.com/hpe-storage/scod">SCOD on GitHub</a>
                </li>
                <li class="">
                    
    <a class="" href="https://github.com/hpe-storage">HPE Storage on GitHub</a>
                </li>
                <li class="">
                    
    <a class="" href="https://hpe.com/storage/containers">Storage for Containers on hpe.com</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">LEGAL</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../legal/contributing/index.html">Contributing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../legal/support/index.html">Support</a>
                </li>
                <li class="">
                    
    <a class="" href="../../legal/license/index.html">License</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">HPE Storage Container Orchestrator Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>PARTNER ECOSYSTEMS &raquo;</li>
        
      
    
    <li>Red Hat OpenShift</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h1>
<p>HPE and Red Hat have a long standing partnership to provide jointly supported software, platform and services with the absolute best customer experience in the industry.</p>
<p>Red Hat OpenShift uses open source Kubernetes and various other components to deliver a PaaS experience that benefits both developers and operations. This packaged experience differs slightly on how you would deploy and use the HPE volume drivers and this page serves as the authoritative source for all things HPE primary storage and Red Hat OpenShift.</p>
<div class="toc">
<ul>
<li><a href="#overview">Overview</a><ul>
<li><a href="#openshift_4">OpenShift 4</a><ul>
<li><a href="#certified_combinations">Certified combinations</a></li>
<li><a href="#deployment">Deployment</a><ul>
<li><a href="#prerequisites">Prerequisites</a></li>
<li><a href="#caveats">Caveats</a></li>
<li><a href="#openshift_cli">OpenShift CLI</a></li>
<li><a href="#openshift_web_console">OpenShift web console</a></li>
<li><a href="#additional_information">Additional information</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#openshift_3">OpenShift 3</a></li>
</ul>
</li>
</ul>
</div>
<h2 id="openshift_4">OpenShift 4<a class="headerlink" href="#openshift_4" title="Permanent link">&para;</a></h2>
<p>Software deployed on OpenShift 4 follows the <a href="https://kubernetes.io/docs/concepts/extend-kubernetes/operator/">Operator pattern</a>. CSI drivers are no exception.</p>
<h3 id="certified_combinations">Certified combinations<a class="headerlink" href="#certified_combinations" title="Permanent link">&para;</a></h3>
<p>Software delivered through the HPE and Red Hat partnership follows a rigorous certification process and only qualify what's listed in the following table.</p>
<table>
<thead>
<tr>
<th>Status</th>
<th>Red Hat OpenShift</th>
<th>HPE CSI Operator</th>
<th>Container Storage Providers</th>
</tr>
</thead>
<tbody>
<tr>
<td>Certified</td>
<td>4.2</td>
<td>1.2.0</td>
<td>Nimble, 3PAR and Primera</td>
</tr>
<tr>
<td>Certified</td>
<td>4.3</td>
<td>1.2.0</td>
<td>Nimble, 3PAR and Primera</td>
</tr>
<tr>
<td>Certified</td>
<td>4.3, 4.4</td>
<td>1.3.0</td>
<td>Nimble, 3PAR and Primera</td>
</tr>
</tbody>
</table>
<p>Check this table periodically for future releases.</p>
<div class="admonition seealso">
<p class="admonition-title">Pointers</p>
<p>Other combinations may work but will not be supported.<br />
Both Red Hat Enterprise Linux and Red Hat CoreOS worker nodes are supported.</p>
</div>
<h3 id="deployment">Deployment<a class="headerlink" href="#deployment" title="Permanent link">&para;</a></h3>
<p>The HPE CSI Operator for Kubernetes needs to be installed through the interfaces provided by Red Hat. Do not follow the instructions found on OperatorHub.io. </p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>There's a tutorial available on YouTube accessible throught the <a href="../../learn/video_gallery/index.html#install_the_hpe_csi_operator_for_kubernetes_on_red_hat_openshift">Video Gallery</a> on how to install and use the HPE CSI Operator on Red Hat OpenShift.</p>
</div>
<h4 id="prerequisites">Prerequisites<a class="headerlink" href="#prerequisites" title="Permanent link">&para;</a></h4>
<p>The HPE CSI Driver needs to run in privileged mode and needs access to host ports, host network and should be able to mount hostPath volumes. Hence, before deploying HPE CSI Operator on OpenShift, please create the following <code>SecurityContextConstraints</code> (SCC) to allow the CSI driver to be running with these privileges.</p>
<p>Download the SCC to where you have access to <code>oc</code> and the OpenShift cluster:</p>
<p> <pre><code class=markdown>curl -sL https://raw.githubusercontent.com/hpe-storage/co-deployments/master/operators/hpe-csi-operator/deploy/scc.yaml &gt; hpe-csi-scc.yaml
</code></pre></p>
<p>Change <code>my-hpe-csi-operator</code> to the name of the project (e.g. <code>hpe-csi-driver</code> below) where the CSI Operator is being deployed.</p>
<p> <pre><code class=markdown>oc new-project hpe-csi-driver --display-name=&quot;HPE CSI Driver for Kubernetes&quot;
sed -i 's/my-hpe-csi-operator/hpe-csi-driver/g' hpe-csi-scc.yaml
</code></pre></p>
<p>Deploy the SCC:</p>
<p> <pre><code class=markdown>oc create -f hpe-csi-scc.yaml
securitycontextconstraints.security.openshift.io/hpe-csi-scc created
</code></pre></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Make note of the project name as it's needed for the Operator deployment in the next steps.</p>
</div>
<h4 id="caveats">Caveats<a class="headerlink" href="#caveats" title="Permanent link">&para;</a></h4>
<p>At this time of writing (CSI Operator 1.2.0) the default <code>StorageClass</code> being shipped with the CSI driver is not very useful for OpenShift as it doesn't allow applications to write in the <code>PersistentVolumes</code>. Make sure to deploy a new <code>StorageClass</code> with <code>.parameters.fsMode</code> set to <code>"0770"</code>. This caveat will be removed in subsequent releases.</p>
<ul>
<li>Learn how to create a base <code>StorageClass</code> in <a href="../../csi_driver/using.html#base_storageclass_parameters">using the CSI driver</a>.</li>
</ul>
<h4 id="openshift_cli">OpenShift CLI<a class="headerlink" href="#openshift_cli" title="Permanent link">&para;</a></h4>
<p>This provides an example Operator deployment using <code>oc</code>. If you want to use the web console, proceed to the <a href="#openshift_web_console">next section</a>.</p>
<p>It's assumed the SCC has been applied to the project and have <code>kube:admin</code> privileges. As an example, we'll deploy to the <code>hpe-csi-driver</code> project as described in previous steps.</p>
<p>First, an <code>OperatorGroup</code> needs to be created.</p>
<p> <pre><code class=yaml>apiVersion: operators.coreos.com/v1
kind: OperatorGroup
metadata:
  name: hpe-csi-driver-for-kubernetes
  namespace: hpe-csi-driver
spec:
  targetNamespaces:
  - hpe-csi-driver
</code></pre></p>
<p>Next, create a <code>Subscription</code> to the Operator.</p>
<p> <pre><code class=yaml>apiVersion: operators.coreos.com/v1alpha1
kind: Subscription
metadata:
  name: hpe-csi-operator
  namespace: hpe-csi-driver
spec:
  channel: stable
  name: hpe-csi-operator
  source: certified-operators
  sourceNamespace: openshift-marketplace
</code></pre></p>
<p>The Operator will now be installed on the OpenShift cluster. Before instantiating a CSI driver, watch the roll-out of the Operator.</p>
<p> <pre><code class=markdown>oc rollout status deploy/hpe-csi-operator -n hpe-csi-driver
Waiting for deployment &quot;hpe-csi-operator&quot; rollout to finish: 0 of 1 updated replicas are available...
deployment &quot;hpe-csi-operator&quot; successfully rolled out
</code></pre></p>
<p>The next step is to create a <code>HPECSIDriver</code> object. It's unique per backend CSP.</p>
<div class=md-fenced-code-tabs id=tab-tab-group-6><input name=tab-group-6 type=radio id=tab-group-6-0_markdown checked=checked class=code-tab data-lang=markdown aria-controls=tab-group-6-0_markdown-panel role=tab><label for=tab-group-6-0_markdown class=code-tab-label data-lang=markdown id=tab-group-6-0_markdown-label>HPE Nimble Storage</label><div class=code-tabpanel role=tabpanel data-lang=markdown id=tab-group-6-0_markdown-panel aria-labelledby=tab-group-6-0_markdown-label><pre><code class=markdown>apiVersion: storage.hpe.com/v1
kind: HPECSIDriver
metadata:
  name: csi-driver
  namespace: hpe-csi-driver
spec:
  backendType: nimble
  imagePullPolicy: Always
  logLevel: info
  secret:
    backend: 192.168.1.1
    create: true
    password: admin
    servicePort: '8080'
    username: admin
  storageClass:
    allowVolumeExpansion: true
    create: true
    defaultClass: false
    name: hpe-standard
    parameters:
      accessProtocol: iscsi
      fsType: xfs
      volumeDescription: Volume created by the HPE CSI Driver for Kubernetes
</code></pre></div><input name=tab-group-6 type=radio id=tab-group-6-1_markdown class=code-tab data-lang=markdown aria-controls=tab-group-6-1_markdown-panel role=tab><label for=tab-group-6-1_markdown class=code-tab-label data-lang=markdown id=tab-group-6-1_markdown-label>HPE 3PAR and Primera</label><div class=code-tabpanel role=tabpanel data-lang=markdown id=tab-group-6-1_markdown-panel aria-labelledby=tab-group-6-1_markdown-label><pre><code class=markdown>apiVersion: storage.hpe.com/v1
kind: HPECSIDriver
metadata:
  name: csi-driver
  namespace: hpe-csi-driver
spec:
  backendType: primera3par
  imagePullPolicy: Always
  logLevel: info
  secret:
    backend: 10.10.10.1
    create: true
    password: 3pardata
    servicePort: '8080'
    username: 3paradm
  storageClass:
    allowVolumeExpansion: true
    create: true
    defaultClass: false
    name: hpe-standard
    parameters:
      accessProtocol: iscsi
      fsType: xfs
      volumeDescription: Volume created by the HPE CSI Driver for Kubernetes
</code></pre></div></div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As noted in the <a href="#caveats">caveats</a>, the installed <code>StorageClass</code> is not very useful for OpenShift. Create a new base <code>StorageClass</code> by following the steps in <a href="../../csi_driver/using.html#base_storageclass_parameters">using the CSI driver</a>.</p>
</div>
<h4 id="openshift_web_console">OpenShift web console<a class="headerlink" href="#openshift_web_console" title="Permanent link">&para;</a></h4>
<p>Once the SCC has been applied to the project, login to the OpenShift web console as <code>kube:admin</code> and navigate to <strong>Operators -&gt; OperatorHub</strong>.</p>
<p><img alt="Search for HPE" src="img/webcon-1.png" />
<em>Search for 'HPE' in the search field.</em></p>
<p><img alt="Select the Operator and click Install" src="img/webcon-2.png" />
<em>Select the HPE CSI Operator and click 'Install'.</em></p>
<p><img alt="Select subscribe" src="img/webcon-3.png" />
<em>In the next pane, click 'Subscribe'.</em></p>
<p><img alt="Operator installed" src="img/webcon-4.png" />
<em>The HPE CSI Operator is now installed.</em></p>
<p><img alt="Create a new instance" src="img/webcon-5.png" />
<em>Click the HPE CSI Operator, in the next pane, click 'Create Instance'.</em></p>
<p><img alt="Supply parameters" src="img/webcon-6.png" />
<em>Configure the instance with the desired values<sup>!</sup>.</em></p>
<div class="admonition note">
<p class="admonition-title">Values</p>
<p>The required parameters are <code>.spec.backendType</code>, <code>.spec.secret.backend</code> and the credentials for the backend (<code>.spec.secret.username</code> and <code>.spec.secret.password</code>).</p>
</div>
<p>By navigating to the Developer view, it should now be possible to inspect the CSI driver and Operator topology.</p>
<p><img alt="Operator Topology" src="img/webcon-7.png" /></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As noted in the <a href="#caveats">caveats</a>, the installed <code>StorageClass</code> is not very useful for OpenShift. Create a new base <code>StorageClass</code> by following the steps in <a href="../../csi_driver/using.html#base_storageclass_parameters">using the CSI driver</a>.</p>
</div>
<h4 id="additional_information">Additional information<a class="headerlink" href="#additional_information" title="Permanent link">&para;</a></h4>
<p>At this point the CSI driver is managed like any other Operator on Kubernetes and the life-cycle management capabilities may be explored further in the <a href="https://docs.openshift.com/container-platform/4.3/operators/olm-what-operators-are.html">official Red Hat OpenShift documentation</a>.</p>
<h2 id="openshift_3">OpenShift 3<a class="headerlink" href="#openshift_3" title="Permanent link">&para;</a></h2>
<p>Customers still using OpenShift 3 may use any of the <a href="../../flexvolume_driver">legacy FlexVolume drivers</a> for managing persistent storage.</p>
              
            </div>
          </div>

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../../learn/containers101/index.html" class="btn btn-neutral float-right" title="Cloud-Native, Containers & DevOps">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../rancher_labs/index.html" class="btn btn-neutral" title="Rancher Labs"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2020 Hewlett Packard Enterprise Development LP<br />Give <a href="https://github.com/hpe-storage/scod/issues/new?title=partners/redhat_openshift/index.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../rancher_labs/index.html" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../../learn/containers101/index.html" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
