<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
    
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Hewlett Packard Enterprise">
  <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta property="og:title" content="HPE Storage Container Orchestrator Documentation"/>
    <meta property="og:description" content="This is an umbrella documentation project for all Kubernetes and Docker integrations for HPE primary storage tailored for IT Ops, developers and partners. Including HPE 3PAR and Primera, HPE Cloud Volumes and HPE Nimble Storage."/>
    <meta property="og:locale" content="en_US"/>
    <meta property="og:url" content="https://scod.hpedev.io"/>
    <meta property="og:type" content="website"/>
    <meta property="og:image" content="https://scod.hpedev.io/img/hpe-social-og-image01.jpg"/>
    <meta property="og:image:width" content="1200"/>
    <meta property="og:image:height" content="630"/>
    
  <title>HPE 3PAR and Primera - HPE Storage Container Orchestrator Documentation</title>
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css">
  <link href="../../css/hpedev.css" rel="stylesheet">
  
  <script>
    // Current page data
    var mkdocs_page_name = "HPE 3PAR and Primera";
    var mkdocs_page_input_path = "container_storage_provider/hpe_3par_primera/index.md";
    var mkdocs_page_url = "/container_storage_provider/hpe_3par_primera/index.html";
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-79554149-3', 'auto');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> HPE Storage Container Orchestrator Documentation</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
	<ul class="current">
	  
          
            <li class="toctree-l1">
		
    <span class="caption-text">WELCOME</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../welcome/index.html">Get started!</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">HPE CSI DRIVER FOR KUBERNETES</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../csi_driver/index.html">Overview</a>
                </li>
                <li class="">
                    
    <a class="" href="../../csi_driver/deployment.html">Deployment</a>
                </li>
                <li class="">
                    
    <a class="" href="../../csi_driver/using.html">Using</a>
                </li>
                <li class="">
                    
    <a class="" href="../../csi_driver/monitor.html">Pod Monitor</a>
                </li>
                <li class="">
                    
    <a class="" href="../../csi_driver/diagnostics.html">Diagnostics</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">CONTAINER STORAGE PROVIDERS</span>
    <ul class="subnav">
                <li class=" current">
                    
    <a class="current" href="index.html">HPE 3PAR and Primera</a>
    <ul class="subnav">
            
    <li class="toctree-l3"><a href="#introduction">Introduction</a></li>
    
        <ul>
        
            <li><a class="toctree-l4" href="#platform_requirements">Platform requirements</a></li>
        
            <li><a class="toctree-l4" href="#storageclass_example">StorageClass example</a></li>
        
            <li><a class="toctree-l4" href="#storageclass_parameters">StorageClass parameters</a></li>
        
            <li><a class="toctree-l4" href="#volumesnapshotclass_parameters">VolumeSnapshotClass parameters</a></li>
        
            <li><a class="toctree-l4" href="#support">Support</a></li>
        
        </ul>
    

    </ul>
                </li>
                <li class="">
                    
    <a class="" href="../hpe_nimble_storage/index.html">HPE Nimble Storage</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">LEGACY FLEXVOLUME DRIVER</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../flexvolume_driver/container_provider/index.html">Container Provider: Nimble and CV</a>
                </li>
                <li class="">
                    
    <a class="" href="../../flexvolume_driver/hpe_3par_primera_installer/index.html">Ansible installer for 3PAR/Primera</a>
                </li>
                <li class="">
                    
    <a class="" href="../../flexvolume_driver/dory/index.html">History: Dory and Doryd </a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">DOCKER VOLUME PLUGINS</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../docker_volume_plugins/hpe_cloud_volumes/index.html">HPE Cloud Volumes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../docker_volume_plugins/hpe_nimble_storage/index.html">HPE Nimble Storage</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">PARTNER ECOSYSTEMS</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../partners/rancher_labs/index.html">Rancher Labs</a>
                </li>
                <li class="">
                    
    <a class="" href="../../partners/redhat_openshift/index.html">Red Hat OpenShift</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">LEARN</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../learn/containers101/index.html">Cloud-Native, Containers & DevOps</a>
                </li>
                <li class="">
                    
    <a class="" href="../../learn/persistent_storage/index.html">Persistent Storage for Kubernetes</a>
                </li>
                <li class="">
                    
    <a class="" href="../../learn/introduction_to_containers/index.html">For HPE partners:<br />&nbsp;&nbsp; Introduction to Containers</a>
                </li>
                <li class="">
                    
    <a class="" href="../../learn/video_gallery/index.html">Video Gallery</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">COMMUNITY</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="https://developer.hpe.com">HPE Developer Community</a>
                </li>
                <li class="">
                    
    <a class="" href="https://slack.hpedev.io">Sign up to HPE DEV on Slack</a>
                </li>
                <li class="">
                    
    <a class="" href="https://github.com/hpe-storage/scod/issues/new?title=I have some feedback on SCOD">Got feedback?</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">EXTERNAL LINKS</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="https://github.com/hpe-storage/scod">SCOD on GitHub</a>
                </li>
                <li class="">
                    
    <a class="" href="https://github.com/hpe-storage">HPE Storage on GitHub</a>
                </li>
                <li class="">
                    
    <a class="" href="https://hpe.com/storage/containers">Storage for Containers on hpe.com</a>
                </li>
    </ul>
	    </li>
          
            <li class="toctree-l1">
		
    <span class="caption-text">LEGAL</span>
    <ul class="subnav">
                <li class="">
                    
    <a class="" href="../../legal/contributing/index.html">Contributing</a>
                </li>
                <li class="">
                    
    <a class="" href="../../legal/support/index.html">Support</a>
                </li>
                <li class="">
                    
    <a class="" href="../../legal/license/index.html">License</a>
                </li>
    </ul>
	    </li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">HPE Storage Container Orchestrator Documentation</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>CONTAINER STORAGE PROVIDERS &raquo;</li>
        
      
    
    <li>HPE 3PAR and Primera</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h1>
<p>The HPE 3PAR and Primera Container Storage Provider integrates as part of the <a href="../../csi_driver/index.html">HPE CSI Driver for Kubernetes</a>. The CSP abstract the data management capabilities of the array for use by Kubernetes. </p>
<div class="toc">
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#platform_requirements">Platform requirements</a><ul>
<li><a href="#spock">SPOCK</a></li>
<li><a href="#user_role_requirements">User role requirements</a></li>
</ul>
</li>
<li><a href="#storageclass_example">StorageClass example</a></li>
<li><a href="#storageclass_parameters">StorageClass parameters</a><ul>
<li><a href="#common_parameters_for_provisioning">Common parameters for provisioning</a></li>
<li><a href="#primera_data_reduction_volumes">Primera Data Reduction volumes</a></li>
<li><a href="#pod_inline_volume_parameters_local_ephemeral_volumes">Pod inline volume parameters (Local Ephemeral Volumes)</a></li>
<li><a href="#import_volume">Import volume</a></li>
<li><a href="#cloning_parameters">Cloning parameters</a></li>
<li><a href="#snapshotting_a_volume">Snapshotting a volume</a></li>
<li><a href="#applying_qos_rules_qosname">Applying QOS Rules (qosName)</a></li>
<li><a href="#remote_copy_with_peer_persistence_synchronous_replication">Remote Copy with Peer Persistence synchronous replication</a></li>
<li><a href="#target_portal_ips">Target Portal IPs</a></li>
</ul>
</li>
<li><a href="#volumesnapshotclass_parameters">VolumeSnapshotClass parameters</a><ul>
<li><a href="#import_snapshot">Import Snapshot</a></li>
</ul>
</li>
<li><a href="#support">Support</a></li>
</ul>
</li>
</ul>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For help getting started with deploying the HPE CSI Driver using HPE Primera or 3PAR Storage, check out the <a href="https://developer.hpe.com/blog/9o7zJkqlX5cErkrzgopL/tutorial-how-to-get-started-with-the-hpe-csi-driver-and-hpe-primera-and-">tutorial over at HPE DEV</a>.</p>
</div>
<h2 id="platform_requirements">Platform requirements<a class="headerlink" href="#platform_requirements" title="Permanent link">&para;</a></h2>
<p>Always check the corresponding CSI driver version in <a href="../../csi_driver/index.html#compatibility_and_support">compatibility and support</a> and <a href="#spock">SPOCK</a> for latest support matrix for the HPE 3PAR and Primera Container Storage Provider.</p>
<table>
<thead>
<tr>
<th>CSI</th>
<th>Linux OS</th>
<th>OpenShift</th>
<th>Kubernetes</th>
<th>3PAR and Primera OS</th>
</tr>
</thead>
<tbody>
<tr>
<td>v1.3.0</td>
<td>- CentOS: 7.7 <br /> - RHEL: 7.6, 7.7 / RHCOS</td>
<td>OpenShift 4.2/4.3 with RHEL 7.6 or 7.7 or RHCOS as worker nodes</td>
<td>K8s 1.16-1.18</td>
<td>- 3PAR OS: 3.3.1 (FC &amp; iSCSI) <br /> - Primera OS: 4.0.0, 4.1.0 (FC only), 4.2.0</td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>• Minimum 2 iSCSI IP ports should be in ready state<br />
• FC array should be in ready state and zoned with initiator hosts<br />
• FC supported only on Bare metal and Fabric SAN</p>
</div>
<h4 id="spock">SPOCK<a class="headerlink" href="#spock" title="Permanent link">&para;</a></h4>
<p>Refer to Hewlett Packard Enterprise Single Point of Connectivity Knowledge (SPOCK) for HPE storage products for specific platform details (requires a HPE Passport account).</p>
<ul>
<li><a href="https://h20272.www2.hpe.com/SPOCK/Pages/spock2Html.aspx?htmlFile=hw_3par.html">3PAR</a></li>
<li><a href="https://h20272.www2.hpe.com/SPOCK/Pages/spock2Html.aspx?htmlFile=hw_primera.html">Primera</a></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The documentation reflected here always corresponds to the latest supported version and may contain references to future features and capabilities.</p>
</div>
<h4 id="user_role_requirements">User role requirements<a class="headerlink" href="#user_role_requirements" title="Permanent link">&para;</a></h4>
<p>The CSP requires access to a user with either <code>edit</code> or the <code>super</code> role. It's recommended to use the <code>edit</code> role for least privilege practices.</p>
<h2 id="storageclass_example">StorageClass example<a class="headerlink" href="#storageclass_example" title="Permanent link">&para;</a></h2>
<p>A <code>StorageClass</code> is used to provision an HPE 3PAR or Primera Storage-backed persistent volume. Please see <a href="../../csi_driver/using.html#base_storageclass_parameters">using the HPE CSI Driver</a> for additional base <code>StorageClass</code> examples like CSI snapshots and clones. </p>
<p>Here is an example of a <code>StorageClass</code> using the HPE 3PAR and Primera CSP. Please see <a href="#common_parameters_for_provisioning">common parameters</a> for additional parameter options.</p>
<p> <pre><code class=markdown>apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: 3par-sc
provisioner: csi.hpe.com
allowVolumeExpansion: true
parameters:
  csi.storage.k8s.io/fstype: ext4
  csi.storage.k8s.io/provisioner-secret-name: primera3par-secret
  csi.storage.k8s.io/provisioner-secret-namespace: kube-system
  csi.storage.k8s.io/controller-publish-secret-name: primera3par-secret
  csi.storage.k8s.io/controller-publish-secret-namespace: kube-system
  csi.storage.k8s.io/node-stage-secret-name: primera3par-secret
  csi.storage.k8s.io/node-stage-secret-namespace: kube-system
  csi.storage.k8s.io/node-publish-secret-name: primera3par-secret
  csi.storage.k8s.io/node-publish-secret-namespace: kube-system
  csi.storage.k8s.io/controller-expand-secret-name: primera3par-secret
  csi.storage.k8s.io/controller-expand-secret-namespace: kube-system
  cpg: FC_r6
  provisioning_type: tpvv
  accessProtocol: iscsi
</code></pre></p>
<h2 id="storageclass_parameters">StorageClass parameters<a class="headerlink" href="#storageclass_parameters" title="Permanent link">&para;</a></h2>
<p>All parameters enumerated reflects the current version and may contain unannounced features and capabilities. </p>
<h3 id="common_parameters_for_provisioning">Common parameters for provisioning<a class="headerlink" href="#common_parameters_for_provisioning" title="Permanent link">&para;</a></h3>
<p>These parameters are used for volume provisioning and supported platforms.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Option</th>
<th>Description</th>
<th>3PAR</th>
<th>Primera</th>
</tr>
</thead>
<tbody>
<tr>
<td>accessProtocol <br /> (required)</td>
<td>fc</td>
<td>The access protocol to use when accessing the persistent volume.</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td></td>
<td>iscsi</td>
<td>The access protocol to use when accessing the persistent volume. Requires Primera OS 4.2+</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td>cpg <br /></td>
<td>Text</td>
<td>The name of existing CPG to be used for volume provisioning. If the cpg parameter is not specified, the CSP will automatically set cpg parameter based upon a CPG available to 3PAR or Primera array.</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td>snap_cpg</td>
<td>Text</td>
<td>The name of the snapshot CPG to be used for volume provisioning. Defaults to value of <code>cpg</code> if not specified.</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td>compression</td>
<td>Boolean</td>
<td>Indicates that the volume should be compressed.</td>
<td><strong>X</strong></td>
<td></td>
</tr>
<tr>
<td>provisioning_type <br /></td>
<td>tpvv</td>
<td>Indicates Thin provisioned volume type. Default: tpvv</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td></td>
<td>full</td>
<td>Indicates Full provisioned volume type.</td>
<td><strong>X</strong></td>
<td></td>
</tr>
<tr>
<td></td>
<td>dedup</td>
<td>Indicates Thin Deduplication volume type.</td>
<td><strong>X</strong></td>
<td></td>
</tr>
<tr>
<td></td>
<td>reduce</td>
<td>Indicates Thin Deduplication/Compression volume type.</td>
<td></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td>importVol</td>
<td>Text</td>
<td>Name of the volume to import.</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td>importVolAsClone</td>
<td>Text</td>
<td>Name of the volume to clone and import.</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td>cloneOf</td>
<td>Text</td>
<td>Name of the <code>PersistentVolumeClaim</code> to clone.</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td>virtualCopyOf</td>
<td>Text</td>
<td>Name of the <code>PersistentVolumeClaim</code> to snapshot.</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td>qosName</td>
<td>Text</td>
<td>Name of the volume set which has QoS rules applied.</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td>remoteCopyGroup <br /></td>
<td>Text</td>
<td>Name of a new or existing remote copy group on HPE Primera/3PAR array.</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td>replicationDevices <br /></td>
<td>Text <br /></td>
<td>Indicates name of custom resource of type <code>hpereplicationdeviceinfos</code>.</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
<tr>
<td>iscsiPortalIps <br /></td>
<td>Text <br /></td>
<td>Comma separated list of HPE Primera/3PAR iSCSI port IPs.</td>
<td><strong>X</strong></td>
<td><strong>X</strong></td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The HPE CSI Driver allows the <code>PersistentVolumeClaim</code> to override the <code>StorageClass</code> parameters by annotating the <code>PersistentVolumeClaim</code>. Please see <a href="../../csi_driver/using.html#using_pvc_overrides">Using PVC Overrides</a> for more details.</p>
</div>
<h3 id="primera_data_reduction_volumes">Primera Data Reduction volumes<a class="headerlink" href="#primera_data_reduction_volumes" title="Permanent link">&para;</a></h3>
<p>These parameters are used to create Primera Data Reduction (Thinly Provisioned with Deduplication/Compression enabled) volumes. Please see <a href="#common_parameters_for_provisioning">Common Parameters</a> for more details.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>accessProtocol</td>
<td>fc</td>
<td>The access protocol to use when accessing the persistent volume.</td>
</tr>
<tr>
<td>cpg</td>
<td>Text</td>
<td>The name of existing CPG to be used for volume provisioning.</td>
</tr>
<tr>
<td>snap_cpg</td>
<td>Text</td>
<td>The name of the snapshot CPG to be used for volume provisioning. Defaults to value of <code>cpg</code> if not specified.</td>
</tr>
<tr>
<td>provisioning_type</td>
<td>reduce</td>
<td><strong>Required</strong></td>
</tr>
</tbody>
</table>
<p>Example <code>StorageClass</code> for provisioning Primera Data Reduction volumes</p>
<p> <pre><code class=markdown>apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: primera-reduce-sc
provisioner: csi.hpe.com
allowVolumeExpansion: true
parameters:
  csi.storage.k8s.io/fstype: ext4
  csi.storage.k8s.io/provisioner-secret-name: primera3par-secret
  csi.storage.k8s.io/provisioner-secret-namespace: kube-system
  csi.storage.k8s.io/controller-publish-secret-name: primera3par-secret
  csi.storage.k8s.io/controller-publish-secret-namespace: kube-system
  csi.storage.k8s.io/node-stage-secret-name: primera3par-secret
  csi.storage.k8s.io/node-stage-secret-namespace: kube-system
  csi.storage.k8s.io/node-publish-secret-name: primera3par-secret
  csi.storage.k8s.io/node-publish-secret-namespace: kube-system
  csi.storage.k8s.io/controller-expand-secret-name: primera3par-secret
  csi.storage.k8s.io/controller-expand-secret-namespace: kube-system
  cpg: SSD_r6
  provisioning_type: reduce
  accessProtocol: fc
</code></pre></p>
<h3 id="pod_inline_volume_parameters_local_ephemeral_volumes">Pod inline volume parameters (Local Ephemeral Volumes)<a class="headerlink" href="#pod_inline_volume_parameters_local_ephemeral_volumes" title="Permanent link">&para;</a></h3>
<p>These parameters are applicable only for Pod inline volumes and to be specified within Pod spec.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>String</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>csi.storage.k8s.io/ephemeral</td>
<td>Boolean</td>
<td>Indicates that the request is for ephemeral inline volume. This is a mandatory parameter and must be set to "true".</td>
</tr>
<tr>
<td>inline-volume-secret-name</td>
<td>Text</td>
<td>A reference to the secret object containing sensitive information to pass to the CSI driver to complete the CSI NodePublishVolume call.</td>
</tr>
<tr>
<td>inline-volume-secret-namespace</td>
<td>Text</td>
<td>The namespace of <code>inline-volume-secret-name</code> for ephemeral inline volume.</td>
</tr>
<tr>
<td>size</td>
<td>Text</td>
<td>The size of ephemeral volume specified in MiB or GiB. If unspecified, a default value will be used.</td>
</tr>
<tr>
<td>accessProtocol</td>
<td>Text</td>
<td>Storage access protocol to use, "iscsi" or "fc".</td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>All parameters are <strong>required</strong> for inline ephemeral volumes.</p>
</div>
<h3 id="import_volume">Import volume<a class="headerlink" href="#import_volume" title="Permanent link">&para;</a></h3>
<p>During the import volume process, any legacy (non-container volumes) or existing docker/k8s volume defined in the <strong>ImportVol</strong> parameter, within a <code>StorageClass</code>, will be renamed to match the <code>PersistentVolumeClaim</code> that leverages the <code>StorageClass</code>. The new volumes will be exposed through the HPE CSI Driver and made available to the Kubernetes cluster. <strong>Note:</strong> All previous Access Control Records and Initiator Groups will be removed from the volume when it is imported.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>accessProtocol</td>
<td>fc or iscsi</td>
<td>The access protocol to use when accessing the persistent volume.</td>
</tr>
<tr>
<td>importVol</td>
<td>Text</td>
<td>The name of the HPE Primera or 3PAR volume to import.</td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>• <strong>No other parameters</strong> are required in the <code>StorageClass</code> when importing a volume outside of those parameters listed in the table above.<br />
• Support for <code>importVol</code> is available from HPE CSI Driver 1.2.0.</p>
</div>
<h3 id="cloning_parameters">Cloning parameters<a class="headerlink" href="#cloning_parameters" title="Permanent link">&para;</a></h3>
<p>Cloning supports two modes of cloning. Either use <code>cloneOf</code> and reference a <code>PersistentVolumeClaim</code> in the current namespace to clone or use <code>importVolAsClone</code> and reference a HPE Primera or 3PAR volume name to clone and import to Kubernetes.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>cloneOf</td>
<td>Text</td>
<td>The name of the <code>PersistentVolumeClaim</code> to be cloned. <code>cloneOf</code> and <code>importVolAsClone</code> are mutually exclusive.</td>
</tr>
<tr>
<td>importVolAsClone</td>
<td>Text</td>
<td>The name of the HPE Primera or 3PAR volume to clone and import. <code>importVolAsClone</code> and <code>cloneOf</code> are mutually exclusive.</td>
</tr>
<tr>
<td>accessProtocol</td>
<td>fc or iscsi</td>
<td>The access protocol to use when accessing the persistent volume.</td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>• <strong>No other parameters</strong> are required in the <code>StorageClass</code> while cloning outside of those parameters listed in the table above.<br />
• Cloning using above parameters is independent of snapshot <code>CRD</code> availability on Kubernetes and it can be performed on any supported Kubernetes version.<br />
• Support for <code>importVolAsClone</code> and <code>cloneOf</code> is available from HPE CSI Driver 1.3.0.</p>
</div>
<h3 id="snapshotting_a_volume">Snapshotting a volume<a class="headerlink" href="#snapshotting_a_volume" title="Permanent link">&para;</a></h3>
<p>During snapshotting process, any existing <code>PersistentVolumeClaim</code> defined in the <code>virtualCopyOf</code> parameter within a <code>StorageClass</code>, will be snapped as <code>PersistentVolumeClaim</code> and exposed through the HPE CSI Driver and made available to the Kubernetes cluster.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>accessProtocol</td>
<td>fc or iscsi</td>
<td>The access protocol to use when accessing the persistent volume.</td>
</tr>
<tr>
<td>virtualCopyOf</td>
<td>Text</td>
<td>The name of existing <code>PersistentVolumeClaim</code> to be snapped</td>
</tr>
</tbody>
</table>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>• <strong>No other parameters</strong> are required in the <code>StorageClass</code> when snapshotting a volume outside of those parameters listed in the table above.<br />
• Snapshotting using <code>virtualCopyOf</code> is independent of snapshot <code>CRD</code> availability on Kubernetes and it can be performed on any supported Kubernetes version.<br />
• Support for <code>virtualCopyOf</code> is available from HPE CSI Driver 1.3.0.</p>
</div>
<h3 id="applying_qos_rules_qosname">Applying QOS Rules (qosName)<a class="headerlink" href="#applying_qos_rules_qosname" title="Permanent link">&para;</a></h3>
<p>In the HPE Primera or 3PAR Storage system, the QoS rules are applied to a volume set. To apply QoS rules to a <code>PersistentVolumeClaim</code>, create a volume set in the HPE Primera or 3PAR, apply QoS rules to the volume set and set the <code>qosName</code> parameter within a <code>StorageClass</code> to the name of the HPE Primera or 3PAR volume set.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>qosName</td>
<td>Text</td>
<td>Name of the HPE Primera or 3PAR volume set which has QoS rules. This parameter is optional. If specified, the <code>PersistentVolumeClaim</code> will be associated with the HPE Primera or 3PAR volume set, for purposes of applying the QoS rules.</td>
</tr>
</tbody>
</table>
<h3 id="remote_copy_with_peer_persistence_synchronous_replication">Remote Copy with Peer Persistence synchronous replication<a class="headerlink" href="#remote_copy_with_peer_persistence_synchronous_replication" title="Permanent link">&para;</a></h3>
<p>To enable replication within the HPE CSI Driver, the following steps must be completed:</p>
<ul>
<li>Create <code>Secrets</code> for both primary and target HPE Primera or 3PAR arrays. Refer to <a href="../../csi_driver/deployment.html#adding_additional_backends">Adding additional backends</a>.</li>
<li>Create replication custom resource.</li>
<li>Create replication enabled <code>StorageClass</code>.</li>
</ul>
<p>For a tutorial on how to enable replication, check out the blog <a href="https://developer.hpe.com/blog/ppPAlQ807Ah8QGMNl1YE/tutorial-enabling-remote-copy-using-the-hpe-csi-driver-for-kubernetes-on">Enabling Remote Copy using the HPE CSI Driver for Kubernetes on HPE Primera</a></p>
<p>A Custom Resource Definition (CRD) of type <code>hpereplicationdeviceinfos.storage.hpe.com</code>  must be created to define the target array information. The CRD object name will be used to define the <code>StorageClass</code> parameter <strong>replicationDevices</strong>. </p>
<p> <pre><code class=yaml>apiVersion: storage.hpe.com/v1
kind: HPEReplicationDeviceInfo
metadata:
  name: r1
spec:
  target_array_details:
  - targetCpg: &lt;cpg_name&gt;
    targetSnapCpg: &lt;snapcpg_name&gt; #optional
    targetName: &lt;target_array_name&gt;
    targetSecret: &lt;target_secret_name&gt;
    targetSecretNamespace: kube-system
</code></pre></p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>• targetCpg, targetName, targetSecret and targetSecretNamespace are mandatory for <code>HPEReplicationDeviceInfo</code> CRD.<br />
• Currently, the HPE CSI Driver only supports Remote Copy Peer Persistence mode. Async support will be added in a future release.<br /></p>
</div>
<p>These parameters are applicable only for replication. Both parameters are mandatory. If the remote copy volume group (RCG) name, as defined within the <code>StorageClass</code>, does not exist on the HPE Primera or 3PAR array, then a new RCG will be created.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>remoteCopyGroup</td>
<td>Text</td>
<td>Name of new or existing remote copy group on the HPE Primera/3PAR array.</td>
</tr>
<tr>
<td>replicationDevices</td>
<td>Text</td>
<td>Indicates name of <code>hpereplicationdeviceinfos</code> Custom Resource Definition (CRD).</td>
</tr>
</tbody>
</table>
<h3 id="target_portal_ips">Target Portal IPs<a class="headerlink" href="#target_portal_ips" title="Permanent link">&para;</a></h3>
<p>This parameter allows the ability to specify a subset of HPE Primera/3PAR iSCSI ports for iSCSI sessions. By default, the HPE CSI Driver uses all available iSCSI ports.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>iscsiPortalIps</td>
<td>Text</td>
<td>Comma separated list of target portal IPs.</td>
</tr>
</tbody>
</table>
<h2 id="volumesnapshotclass_parameters">VolumeSnapshotClass parameters<a class="headerlink" href="#volumesnapshotclass_parameters" title="Permanent link">&para;</a></h2>
<p>These parameters are for <code>VolumeSnapshotClass</code> objects when using CSI snapshots. The external snapshotter needs to be deployed on the Kubernetes cluster and is usually performed by the Kubernetes vendor. Check <a href="../../csi_driver/using.html#enabling_csi_snapshots">enabling CSI snapshots</a> for more information.</p>
<p>How to use <code>VolumeSnapshotClass</code> and <code>VolumeSnapshot</code> objects is elaborated on in <a href="../../csi_driver/using.html#using_csi_snapshots">using CSI snapshots</a>.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>String</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>read_only</td>
<td>Boolean</td>
<td>Indicates if the snapshot is writable on the 3PAR or Primera array.</td>
</tr>
</tbody>
</table>
<h3 id="import_snapshot">Import Snapshot<a class="headerlink" href="#import_snapshot" title="Permanent link">&para;</a></h3>
<p>During the import snapshot process, any legacy (non-container snapshot) or an existing docker/k8s snapshot defined in the <strong>ImportVol</strong> parameter, within a <code>VolumeSnapshotClass</code>, will be renamed with the prefix "snapshot-". The new snapshot will be exposed through the HPE CSI Driver and made available to the Kubernetes cluster. <strong>Note:</strong> All previous Access Control Records and Initiator Groups will be removed from the snapshot when it is imported.</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>importVol</td>
<td>Text</td>
<td>The name of the 3PAR or Primera snapshot to import.</td>
</tr>
</tbody>
</table>
<h2 id="support">Support<a class="headerlink" href="#support" title="Permanent link">&para;</a></h2>
<p>Please refer to the HPE 3PAR and Primera Container Storage Provider <a href="../../legal/support/index.html#hpe_3par_and_primera_container_storage_provider_support">support statement</a>.</p>
              
            </div>
          </div>

<footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../hpe_nimble_storage/index.html" class="btn btn-neutral float-right" title="HPE Nimble Storage">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../../csi_driver/diagnostics.html" class="btn btn-neutral" title="Diagnostics"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
    <p>Copyright 2020 Hewlett Packard Enterprise Development LP<br />Give <a href="https://github.com/hpe-storage/scod/issues/new?title=container_storage_provider/hpe_3par_primera/index.html">feedback</a> on this page.</p>
    
  </div>
</footer>

        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../../csi_driver/diagnostics.html" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../hpe_nimble_storage/index.html" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>

</body>
</html>
